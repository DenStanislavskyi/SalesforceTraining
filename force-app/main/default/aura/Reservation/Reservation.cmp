<aura:component implements="force:lightningQuickActionWithoutHeader,force:hasRecordId" controller="FindRoutes" >
<aura:attribute name="recordId" type="String"/>
<aura:attribute name="Schedule" type="Schedule__c"/>
<aura:attribute name="Columns" type="List" />
<aura:attribute name="maxRowSelection" type="Integer" default="1"/>
<aura:attribute name="scheduleStartDate" type="Date" />
<aura:attribute name="scheduleEndDate" type="Date" />
<aura:attribute name="arrivalPort" type="String" />
<aura:attribute name="departurePort" type="String" />
<aura:attribute name="selectedSchedule" type="String"/>
<aura:attribute name="isTableReady" type="Boolean" default="false"/>
<aura:attribute name="isScheduleSelected" type="Boolean" default="false"/>    
<aura:attribute name="isNotEmpty" type="Boolean" default="false"/> 
<aura:attribute name="isScheduleFound" type="Boolean" default="false"/>
<aura:handler name="init" value="{!this}" action="{!c.init}"/>
<aura:attribute name="spinner" type="Boolean" default="false"/>
<aura:html tag="style">
    .slds-modal__content {
    height: auto !important;
    }
    .slds-modal__container{
        width: 50% !important;
        max-width: 50% !important;
    }
    
    .slds-p-around--medium {
    padding: 0rem !important;
    }
    .slds-table--fixed-layout{
    padding: 12px;
    }
    
    .cuf-content {
        padding: 0 0rem !important;
        }
        .slds-p-around--medium {
        padding: 0rem !important;
        }
        .slds-modal__content{
        overflow-y:hidden !important;
        height:unset !important;
        max-height:unset !important;
        }

</aura:html>
        <!--<ltng:require styles="{!$Resource.ContainerWidth80}"/>-->
    <div class="slds-modal__header">
        <h2 class="slds-modal__title slds-hyphenate">Schedule Reservation</h2>
    </div>

    
    <lightning:layout horizontalAlign="space">
        <lightning:layoutItem padding="around-small" size="10">
<lightning:card  title="Schedule selection"  >
            <lightning:recordEditForm objectApiName="Route__c">
                <lightning:input type="date"  label="Departure Date"    value="{!v.scheduleStartDate}" />
                <lightning:input type="date"  label="Arrival Date"  value="{!v.scheduleEndDate}"/>
                <lightning:inputField fieldName="Departure_Location__c" value="{!v.departurePort}" />
                <lightning:inputField fieldName="Arrival_Location__c" value="{!v.arrivalPort}" />
                <aura:if isTrue="{!v.spinner}">
                    <lightning:spinner variant="brand" size="large"/>
                </aura:if>
            </lightning:recordEditForm>
            <lightning:button label="Search Schedules" title="Search action" onclick="{!c.getSchedule}"/>  
</lightning:card>


</lightning:layoutItem>
</lightning:layout>
<lightning:layout horizontalAlign="space">
        <lightning:layoutItem padding="around-small" size="10">
<aura:if isTrue="{!v.isTableReady}">
    <aura:if isTrue="{!v.isScheduleFound}">
    <lightning:datatable data="{!v.Schedule}" onrowselection="{!c.onSelectedSchedule}" columns="{!v.Columns }" keyField="Id"  maxRowSelection="{!v.maxRowSelection}"/>
</aura:if>
</aura:if>
</lightning:layoutItem>
</lightning:layout>
<aura:if isTrue="{!v.isScheduleSelected}">
    <lightning:layout horizontalAlign="space">
        <lightning:layoutItem padding="around-small" size="10">
    <lightning:card title="New Reservation" >
        <lightning:recordEditForm objectApiName="Schedule_Reservation__c" onsuccess="{!c.handleClick}"  onerror="{!c.handleError}" aura:id="form">

            <!-- the messages component is for error messages -->
            <lightning:messages />
        
        <lightning:inputField fieldName="Product__c" />
        <lightning:inputField name="TEU" fieldName="TEU__c" onchange = "{!c.activeButton}"/>
      

        <!--<lightning:inputField fieldName="Name" class="slds-hidden"/>-->
        <lightning:inputField fieldName="Opportunity__c" value="{!v.recordId}" class="slds-hidden"/>
        <lightning:inputField fieldName="Schedule__c" value="{!v.selectedSchedule}" class="slds-hidden" />
        <lightning:inputField fieldName="Status__c" value="Locked" class="slds-hidden"/> 
 

    </lightning:recordEditForm>
    </lightning:card>
</lightning:layoutItem>
</lightning:layout>


</aura:if> 



<div class="  slds-modal__footer  ">
    <lightning:button class="slds-button slds-button_neutral"  onclick="{! c.cancelClick }">Cancel</lightning:button>
    <lightning:button class="slds-button slds-button_brand"  onclick="{!c.handleClick}"    disabled ="false"  aura:id="disablebuttonid">Save</lightning:button>
</div>
</aura:component>